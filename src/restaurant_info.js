let restaurant;var newMap;document.addEventListener('DOMContentLoaded',()=>{initMap()}),initMap=()=>{fetchRestaurantFromURL((a,b)=>{a?console.error(a):(self.newMap=L.map('map',{center:[b.latlng.lat,b.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}',{mapboxToken:'pk.eyJ1IjoiamF0aW5wYW5kZXkiLCJhIjoiY2ppc3h5aDduMGZsajNwbGd5MGhscGxwNyJ9.zO-GMJ6zAkDr50YeYOYCGg',maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',id:'mapbox.streets'}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})},fetchRestaurantFromURL=a=>{if(self.restaurant)return void a(null,self.restaurant);const b=getParameterByName('id');b?DBHelper.fetchRestaurantById(b,(c,d)=>{return self.restaurant=d,d?void(fillRestaurantHTML(),a(null,d)):void console.error(c)}):(error='No restaurant id in URL',a(error,null))},fillRestaurantHTML=(a=self.restaurant)=>{const b=document.getElementById('restaurant-name');b.innerHTML=a.name;const c=document.getElementById('restaurant-address');c.innerHTML=a.address;const d=document.getElementById('restaurant-img');d.className='restaurant-img',d.alt='An image from the restaurant'+a.name,d.src=DBHelper.imageUrlForRestaurant(a);const e=document.getElementById('restaurant-cuisine');e.innerHTML=a.cuisine_type,a.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=(a=self.restaurant.operating_hours)=>{const b=document.getElementById('restaurant-hours');for(let c in a){const d=document.createElement('tr'),e=document.createElement('td');e.innerHTML=c,d.appendChild(e);const f=document.createElement('td');f.innerHTML=a[c],d.appendChild(f),b.appendChild(d)}},fillReviewsHTML=(a=self.restaurant.reviews)=>{const b=document.getElementById('reviews-container'),c=document.createElement('h3');if(c.innerHTML='Reviews',b.appendChild(c),!a){const e=document.createElement('p');return e.innerHTML='No reviews yet!',void b.appendChild(e)}const d=document.getElementById('reviews-list');a.forEach(e=>{d.appendChild(createReviewHTML(e))}),b.appendChild(d)},createReviewHTML=a=>{const b=document.createElement('li'),c=document.createElement('p');c.innerHTML=a.name,b.appendChild(c);const d=document.createElement('p');d.innerHTML=a.date,b.appendChild(d);const e=document.createElement('p');e.innerHTML=`Rating: ${a.rating}`,b.appendChild(e);const f=document.createElement('p');return f.innerHTML=a.comments,b.appendChild(f),b},fillBreadcrumb=(a=self.restaurant)=>{const b=document.getElementById('breadcrumb'),c=document.createElement('li');c.innerHTML=a.name,b.appendChild(c)},getParameterByName=(a,b)=>{b||(b=window.location.href),a=a.replace(/[\[\]]/g,'\\$&');const c=new RegExp(`[?&]${a}(=([^&#]*)|&|#|$)`),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g,' ')):'':null};